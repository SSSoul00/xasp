<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kclm.xsap.dao.ConsumeRecordDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.kclm.xsap.entity.ConsumeRecordEntity" id="consumeRecordMap">
        <result property="id" column="id"/>
        <result property="operateType" column="operate_type"/>
        <result property="cardCountChange" column="card_count_change"/>
        <result property="cardDayChange" column="card_day_change"/>
        <result property="moneyCost" column="money_cost"/>
        <result property="operator" column="operator"/>
        <result property="note" column="note"/>
        <result property="memberBindId" column="member_bind_id"/>
        <result property="createTime" column="create_time"/>
        <result property="lastModifyTime" column="last_modify_time"/>
        <result property="version" column="version"/>
    </resultMap>

    <resultMap id="consumeInfo" type="com.kclm.xsap.vo.ConsumeInfoVo">
        <id property="consumeId" column="id"/>
        <result property="cardName" column="name"/>
        <result property="createTime" column="create_time"/>
        <result property="lastModifyTime" column="last_modify_time"/>
        <result property="cardCountChange" column="card_count_change"/>
        <result property="timesRemainder" column="valid_count"/>
        <result property="moneyCost" column="money_cost"/>
        <result property="operateType" column="operate_type"/>
        <result property="operator" column="operator"/>
        <result property="note" column="note"/>
    </resultMap>
    <select id="selectConsumeInfo" resultMap="consumeInfo">

        select tcr.id,
               tmc.name,
               tcr.create_time,
               tcr.last_modify_time,
               tcr.card_count_change,
               tmbr.valid_count,
               tcr.money_cost,
               tcr.operate_type,
               tcr.operator,
               tcr.note
        from t_consume_record tcr,
             t_member_card tmc,
             t_member_bind_record tmbr
        where tcr.member_bind_id = tmbr.id
          and tmbr.card_id = tmc.id
          and tmbr.member_id = #{id}
    </select>


</mapper>